# Шаблон разметки

## Общие принципы

Стремимся к тому, чтобы все макеты укладывались в одну схему: `header + main + footer`. И ни «шапка», ни «подвал», ни область основного содержания не менялись в зависимости от раздела. Никакой дополнительной разметки, никаких специальных классов (за исключением классов `body`).

Для растягивания разделов страницы на всю ширину экрана — внутри ограниченного по ширине `main` — используем технику `margin-left` + `translate`. См. /components/blocks/section.scss:.is-full-bleed.

Для растягивания разделов страницы до средней ширины используем технику отрицательных боковых `margin`, в том числе — с процентными значениями.

## Семантические теги предпочтительней aria-атрибутов

Стараться использовать семантические теги — `nav`, `footer` etc. — а не атрибуты `role`. В частности, не нужны атрибуты [`role='menubar|menu|menuitem'`](https://adrianroselli.com/2017/10/dont-use-aria-menu-roles-for-site-nav.html){:target="_blank"} — ни для `nav`,ни для вложенных `ul`, `li` и `a`.

### Шпаргалка для тех случаев, когда aria-разметка всё-таки необходима

- role='alert'
- role='region' для раздела, размеченного `div`'ом, а не `section`
- role='listbox' / role='option' — для структур, содержащих скрытые
  элементы: каруселей, выпадающих меню, имитирующих `select`

  ```pug
  ul.filter(role='listbox')
    li.filter_item
      a.filter_option(href='?s=feat', role='option', tabindex='-1', aria-selected='true')
      | Featured
  ```
- `role='none'` или `role='presentation'` — для дочерних элементов, не выполняющих функциональную роль. Например, `ul[role='menu']>li[role='none']>a[role='list-item']`
- `role='combobox'` + `aria-autocomplete='list|both'` + `aria-owns='list-id'` + `aria-expanded='false'` - для комбобоксов
- `role='button'` для a-элементов, выполняющих функции кнопок
- `role='navigation|menu'` и `role='menuitem'`, если используется `ul`, не вложенный в `nav`. Роль меню или навигации назначается родительскому элементу — например, `ul`. А роль `menuitem` — интерактивным элементам меню: li (если обрабатываются клики на них), `a` или `button`.
- `role='tree'`, `role='group'` и `role='treeitem'` — для древовидной навигации, аккордеонов.

Интерактивные элементы — модальные / диалоговые окна, выпадающие меню, всплывающие подсказки (tooltip'ы) помечаются aria-атрибутами для того, чтобы их понимали пользователи экранных считывающих устройств.

### Самые популярные aria-атрибуты

- `aria-hidden='true'`. Помечаются иконки, др. декоративные графические элементы, лишние надписи (например, адаптивные варианты).
- `aria-label` и `aria-labelledby`. Помечаются «обёртки» виджетов
- `aria-controls`. Помечаются кнопки управления виджетом. В значении указывается ID виджета: `button(aria-controls='my-dropdown')` … `nav#my-dropdown`
- `aria-haspopup`. Помечаются кнопки управления выпадающими меню и панелями (диалоговые окна к этой категории не относятся): `button(aria-haspopup='true', aria-controls='my-dropdown')`
- `aria-expanded`. Помечаются кнопки управления скрываемыми виджетами — например, выпадающими меню. В значении указывается состояние виджета: `false` или `true`. W3C рекомендует использовать вместе с `aria-haspopup`, хотя Bootstrap и Saleforce игнорируют: `button(aria-controls='my-dropdown', aria-expanded='false')`.

[Подробнее](https://www.w3.org/WAI/ARIA/apg/example-index/){:target="_blank"}.

Для аналитики и скриптов можно добавлять пользовательские атрибуты: `data-analytics-region`, `data-anim-scroll-group`, `data-state` и т.п.

## Сниппеты

`\((.*?)\)` ➜ `[$1]` - заменить круглые скобки pug'а на квадратные emmet'а.

### Запрет индексирования

```html
<!-- noindex-->
Официальная техника Яндекса
<!-- /noindex-->

<!-- googleoff: all-->
Такой синтаксис запрета индексации Googl'ом использует Apple. Но не знаю,
работают ли техника, или это рудимент из прошлого
<!-- googleon: all-->
```

В ссылку можно добавить атрибут `rel="nofollow"`: `a(href='url' rel='nofollow') label`.


## Собственно, шаблон

Единый источник достоверных данных (Single source of truth, SSOT) — сниппеты VS Code:

- Минималистский `head` для боевых сайтов — +head
- Полный шаблон, с Apple Web App Meta Tags и т.п. — +html
